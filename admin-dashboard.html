<!DOCTYPE html>
<html lang="th">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Admin Dashboard - Elixopay</title>
	<link rel="stylesheet" href="styles/theme.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js" defer></script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	<style>
		body { font-family: 'Inter', system-ui, sans-serif; background: #0d1117; color: #e2e8f0; margin:0; }
		body.light { background:#f8fafc; color:#0f172a; }
		.topbar { background:#1e293b; padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid rgba(255,255,255,.08); }
		body.light .topbar { background:#ffffff; border-bottom-color:#e2e8f0; }
		.logo { font-weight:700; font-size:1.5rem; color:#6366f1; text-decoration:none; }
		.topbar-actions { display:flex; gap:1rem; align-items:center; }
		.container { max-width:1400px; margin:0 auto; padding:2rem 1.5rem; }
		.header { margin-bottom:2rem; }
		.header h1 { font-size:2rem; margin:0 0 .5rem; }
		.header p { color:#94a3b8; margin:0; }
		.stats { display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:1.5rem; margin-bottom:2rem; }
		.stat-card { background:#1e293b; padding:2rem; border-radius:12px; border:1px solid rgba(255,255,255,.08); transition:all .2s; }
		body.light .stat-card { background:#ffffff; border-color:#e2e8f0; }
		.stat-card:hover { transform:translateY(-2px); box-shadow:0 8px 16px rgba(0,0,0,.2); }
		.stat-icon { width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:1.5rem; margin-bottom:1rem; }
		.stat-value { font-size:2rem; font-weight:700; margin-bottom:.5rem; }
		.stat-label { font-size:.85rem; color:#94a3b8; margin-bottom:.5rem; }
		.stat-change { font-size:.75rem; display:flex; align-items:center; gap:.25rem; }
		.stat-change.up { color:#22c55e; }
		.stat-change.down { color:#ef4444; }
		.quick-actions { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:1rem; margin-bottom:2rem; }
		.action-btn { background:#1e293b; border:1px solid rgba(255,255,255,.08); padding:1.5rem; border-radius:12px; text-decoration:none; color:#e2e8f0; display:flex; align-items:center; gap:1rem; transition:all .2s; }
		body.light .action-btn { background:#ffffff; border-color:#e2e8f0; color:#0f172a; }
		.action-btn:hover { background:#2d3748; border-color:#6366f1; transform:translateY(-2px); }
		body.light .action-btn:hover { background:#f8fafc; }
		.action-icon { width:40px; height:40px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:1.25rem; }
		.btn { padding:.75rem 1.5rem; border-radius:8px; font-size:.9rem; font-weight:600; cursor:pointer; border:none; transition:all .2s; text-decoration:none; display:inline-flex; align-items:center; gap:.5rem; }
		.btn-primary { background:#6366f1; color:#fff; }
		.btn-primary:hover { background:#4f46e5; }
		.btn-outline { background:transparent; border:1px solid rgba(99,102,241,.3); color:#6366f1; }
		.btn-outline:hover { background:rgba(99,102,241,.1); border-color:#6366f1; }
		.card { background:#1e293b; border-radius:12px; border:1px solid rgba(255,255,255,.08); overflow:hidden; margin-bottom:2rem; }
		body.light .card { background:#ffffff; border-color:#e2e8f0; }
		.card-header { padding:1.5rem; border-bottom:1px solid rgba(255,255,255,.08); display:flex; justify-content:space-between; align-items:center; }
		body.light .card-header { border-bottom-color:#e2e8f0; }
		.card-title { font-size:1.25rem; font-weight:700; margin:0; }
		.badge { display:inline-block; padding:.35rem .75rem; border-radius:6px; font-size:.75rem; font-weight:600; }
		.badge-pending { background:rgba(251,191,36,.15); color:#fbbf24; }
		.badge-success { background:rgba(34,197,94,.15); color:#22c55e; }
		.badge-danger { background:rgba(239,68,68,.15); color:#ef4444; }
		table { width:100%; border-collapse:collapse; }
		th { text-align:left; padding:1rem 1.5rem; font-size:.85rem; font-weight:600; color:#94a3b8; text-transform:uppercase; letter-spacing:.5px; background:rgba(99,102,241,.05); }
		td { padding:1rem 1.5rem; border-top:1px solid rgba(255,255,255,.08); }
		body.light td { border-top-color:#e2e8f0; }
		.empty-state { text-align:center; padding:3rem 2rem; color:#94a3b8; }
		@media (max-width:768px) {
			.stats { grid-template-columns:1fr; }
			.quick-actions { grid-template-columns:1fr; }
		}
	</style>
</head>
<body>
	<div class="topbar">
		<a href="index.html" class="logo">Elixopay Admin</a>
		<div class="topbar-actions">
			<button id="themeToggle" class="btn btn-outline">
				<i class="fas fa-sun"></i> ‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á
			</button>
			<button onclick="handleLogout()" class="btn btn-outline">
				<i class="fas fa-sign-out-alt"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
			</button>
		</div>
	</div>

	<div class="container">
		<div class="header">
			<h1>üëã ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ Admin</h1>
			<p>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö Elixopay</p>
		</div>

		<div class="stats">
			<div class="stat-card">
				<div class="stat-icon" style="background:rgba(251,191,36,.15); color:#fbbf24;">
					<i class="fas fa-clock"></i>
				</div>
				<div class="stat-value" id="pendingCount">0</div>
				<div class="stat-label">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
				<div class="stat-change up">
					<i class="fas fa-arrow-up"></i>
					<span>+2 ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>
				</div>
			</div>

			<div class="stat-card">
				<div class="stat-icon" style="background:rgba(34,197,94,.15); color:#22c55e;">
					<i class="fas fa-check-circle"></i>
				</div>
				<div class="stat-value" id="approvedCount">0</div>
				<div class="stat-label">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</div>
				<div class="stat-change up">
					<i class="fas fa-arrow-up"></i>
					<span>+5 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</span>
				</div>
			</div>

			<div class="stat-card">
				<div class="stat-icon" style="background:rgba(99,102,241,.15); color:#6366f1;">
					<i class="fas fa-users"></i>
				</div>
				<div class="stat-value" id="totalUsers">0</div>
				<div class="stat-label">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
				<div class="stat-change up">
					<i class="fas fa-arrow-up"></i>
					<span>+12% ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</span>
				</div>
			</div>

			<div class="stat-card">
				<div class="stat-icon" style="background:rgba(239,68,68,.15); color:#ef4444;">
					<i class="fas fa-times-circle"></i>
				</div>
				<div class="stat-value" id="rejectedCount">0</div>
				<div class="stat-label">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</div>
				<div class="stat-change down">
					<i class="fas fa-arrow-down"></i>
					<span>-3% ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</span>
				</div>
			</div>
		</div>

		<div class="card" style="margin-bottom:2rem;">
			<div class="card-header">
				<h2 class="card-title">üöÄ ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡πà‡∏ß‡∏ô</h2>
			</div>
			<div style="padding:1.5rem;">
				<div class="quick-actions">
					<a href="admin-pending.html" class="action-btn">
						<div class="action-icon" style="background:rgba(251,191,36,.15); color:#fbbf24;">
							<i class="fas fa-user-clock"></i>
						</div>
						<div>
							<div style="font-weight:600;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠</div>
							<div style="font-size:.85rem; color:#94a3b8;" id="pendingLabel">0 ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
						</div>
					</a>

					<a href="transactions.html" class="action-btn">
						<div class="action-icon" style="background:rgba(99,102,241,.15); color:#6366f1;">
							<i class="fas fa-exchange-alt"></i>
						</div>
						<div>
							<div style="font-weight:600;">‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°</div>
							<div style="font-size:.85rem; color:#94a3b8;">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
						</div>
					</a>

					<a href="#" class="action-btn" onclick="alert('‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤'); return false;">
						<div class="action-icon" style="background:rgba(34,197,94,.15); color:#22c55e;">
							<i class="fas fa-cog"></i>
						</div>
						<div>
							<div style="font-weight:600;">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</div>
							<div style="font-size:.85rem; color:#94a3b8;">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤</div>
						</div>
					</a>

					<a href="#" class="action-btn" onclick="alert('‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤'); return false;">
						<div class="action-icon" style="background:rgba(168,85,247,.15); color:#a855f7;">
							<i class="fas fa-chart-line"></i>
						</div>
						<div>
							<div style="font-weight:600;">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
							<div style="font-size:.85rem; color:#94a3b8;">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
						</div>
					</a>
				</div>
			</div>
		</div>

		<div class="card">
			<div class="card-header">
				<h2 class="card-title">üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
				<a href="admin-pending.html" class="btn btn-primary">
					<i class="fas fa-list"></i> ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
				</a>
			</div>
			<div style="overflow-x:auto;">
				<table>
					<thead>
						<tr>
							<th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
							<th>‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</th>
							<th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
							<th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</th>
							<th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
							<th style="text-align:center;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
						</tr>
					</thead>
					<tbody id="recentApplications">
						<tr>
							<td colspan="6" class="empty-state">
								<i class="fas fa-inbox" style="font-size:2rem; opacity:.3; display:block; margin-bottom:.5rem;"></i>
								‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<script>
		// Check admin authentication
		function checkAuth() {
			const isAdmin = localStorage.getItem('elixopay-admin-logged-in');
			if (!isAdmin) {
				// Redirect to login with admin mode
				window.location.href = 'login.html?admin=true';
				return false;
			}
			return true;
		}

		// Theme toggle
		const themeToggle = document.getElementById('themeToggle');
		themeToggle.addEventListener('click', () => {
			document.body.classList.toggle('light');
			const isLight = document.body.classList.contains('light');
			themeToggle.innerHTML = isLight 
				? '<i class="fas fa-moon"></i> ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î' 
				: '<i class="fas fa-sun"></i> ‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á';
			localStorage.setItem('elixopay-theme', isLight ? 'light' : 'dark');
		});
		
		// Apply saved theme
		if (localStorage.getItem('elixopay-theme') === 'light') {
			document.body.classList.add('light');
			themeToggle.innerHTML = '<i class="fas fa-moon"></i> ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î';
		}

		// Load statistics
		function loadStats() {
			const stored = localStorage.getItem('elixopay-applications');
			const applications = stored ? JSON.parse(stored) : [];
			
			const pending = applications.filter(a => a.status === 'pending').length;
			const approved = applications.filter(a => a.status === 'approved').length;
			const rejected = applications.filter(a => a.status === 'rejected').length;
			const total = applications.length;

			document.getElementById('pendingCount').textContent = pending;
			document.getElementById('approvedCount').textContent = approved;
			document.getElementById('rejectedCount').textContent = rejected;
			document.getElementById('totalUsers').textContent = total;
			document.getElementById('pendingLabel').textContent = `${pending} ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥`;

			// Load recent applications (last 5)
			loadRecentApplications(applications.slice(-5).reverse());
		}

		// Load recent applications table
		function loadRecentApplications(apps) {
			const tbody = document.getElementById('recentApplications');
			
			if (apps.length === 0) {
				tbody.innerHTML = `<tr><td colspan="6" class="empty-state">
					<i class="fas fa-inbox" style="font-size:2rem; opacity:.3; display:block; margin-bottom:.5rem;"></i>
					‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£
				</td></tr>`;
				return;
			}

			tbody.innerHTML = apps.map(app => {
				const date = new Date(app.registeredAt).toLocaleDateString('th-TH', {
					year: 'numeric', month: 'short', day: 'numeric'
				});
				const statusClass = app.status === 'pending' ? 'badge-pending' : 
								   app.status === 'approved' ? 'badge-success' : 'badge-danger';
				const statusText = app.status === 'pending' ? '‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' : 
								  app.status === 'approved' ? '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß' : '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò';
				
				return `<tr>
					<td><strong>${app.name}</strong></td>
					<td>${app.business}</td>
					<td>${app.email}</td>
					<td>${date}</td>
					<td><span class="badge ${statusClass}">${statusText}</span></td>
					<td style="text-align:center;">
						<a href="admin-pending.html" class="btn btn-outline" style="font-size:.8rem; padding:.5rem .75rem;">
							<i class="fas fa-eye"></i> ‡∏î‡∏π
						</a>
					</td>
				</tr>`;
			}).join('');
		}

		// Logout function
		function handleLogout() {
			if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
				localStorage.removeItem('elixopay-admin-logged-in');
				window.location.href = 'login.html';
			}
		}

		// Initialize
		document.addEventListener('DOMContentLoaded', () => {
			if (!checkAuth()) return;
			loadStats();
			
			// Auto refresh every 5 seconds
			setInterval(loadStats, 5000);
		});
	</script>
</body>
</html>

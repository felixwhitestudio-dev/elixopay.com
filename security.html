<!DOCTYPE html>
<html lang="th">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>Security - Elixopay</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">
	<nav class="bg-white shadow border-b border-gray-200">
		<div class="max-w-5xl mx-auto px-4 py-4 flex justify-between items-center">
			<a href="/dashboard.html" class="text-xl font-bold bg-gradient-to-r from-green-600 to-blue-500 bg-clip-text text-transparent">Elixopay</a>
			<div class="space-x-4 text-sm">
				<a href="/docs.html" class="text-gray-600 hover:text-gray-900">Docs</a>
				<a href="/transactions.html" class="text-gray-600 hover:text-gray-900">Transactions</a>
				<a href="/help.html" class="text-gray-600 hover:text-gray-900">Help</a>
			</div>
		</div>
	</nav>

	<header class="max-w-5xl mx-auto px-4 py-10">
		<h1 class="text-3xl font-bold mb-2">Security Overview</h1>
		<p class="text-gray-600">สรุปมาตรการความปลอดภัยที่ระบบ Elixopay ใช้งาน</p>
	</header>

	<main class="max-w-5xl mx-auto px-4 pb-16 space-y-8">
		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-shield-alt text-green-600 mr-2"></i>Core Protections</h2>
			<ul class="list-disc ml-6 text-sm text-gray-700 space-y-2">
				<li><strong>JWT Authentication</strong>: 128-char secrets & refresh token rotation.</li>
				<li><strong>Password Policy</strong>: Minimum length, complexity enforced.</li>
				<li><strong>Account Lockout</strong>: ป้องกัน brute force (จำกัดจำนวนครั้ง / เวลารอ).</li>
				<li><strong>Rate Limiting</strong>: แยกตาม endpoints (auth, payment, apiKeys).</li>
				<li><strong>Helmet Security Headers</strong>: ป้องกัน XSS / clickjacking เบื้องต้น.</li>
				<li><strong>CORS Restriction</strong>: Allowlist เฉพาะ origin ที่กำหนด.</li>
				<li><strong>Input Validation</strong>: ใช้ express-validator ลด injection risk.</li>
				<li><strong>Stripe Integration</strong>: ใช้ Payment Intents + webhook signature verify.</li>
			</ul>
		</section>

		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-code text-blue-600 mr-2"></i>Headers</h2>
			<div class="bg-gray-900 text-gray-100 text-xs rounded p-4 font-mono overflow-auto">
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 99
X-Content-Type-Options: nosniff
Content-Security-Policy: default-src 'self'
			</div>
			<p class="text-xs text-gray-500 mt-2">(CSP สามารถขยายเพิ่มเติมในอนาคตสำหรับ script-src เฉพาะที่จำเป็น)</p>
		</section>

		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-list-check text-purple-600 mr-2"></i>Hardening Roadmap</h2>
			<ol class="list-decimal ml-6 text-sm text-gray-700 space-y-2">
				<li>เพิ่ม Audit Log ครอบคลุมทุกการเปลี่ยนแปลงสำคัญ</li>
				<li>Implement refresh token rotation & blacklist</li>
				<li>เพิ่ม 2FA (TOTP) ในการล็อกอินผู้ดูแลระบบ</li>
				<li>เพิ่ม Subresource Integrity (SRI) hash ให้ CDN scripts</li>
				<li>แยก Secret ออกจาก build (ใช้ Vault/Secrets Manager)</li>
			</ol>
		</section>

		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-file-alt text-gray-700 mr-2"></i>Reference</h2>
			<p class="text-sm text-gray-700">ดูรายละเอียดเชิงลึกได้ที่ไฟล์ <code class="bg-gray-100 px-1 rounded">SECURITY_README.md</code> ใน repository.</p>
			<a href="/SECURITY_README.md" class="inline-block mt-4 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm">เปิดไฟล์ SECURITY_README.md</a>
		</section>
	</main>

	<footer class="bg-white border-t border-gray-200 py-6 text-center text-sm text-gray-600">© 2024 Elixopay Security</footer>
</body>
</html>

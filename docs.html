<!DOCTYPE html>
<html lang="th">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>API Documentation - Elixopay</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">
	<!-- Debug banner (temporary) -->
	<div id="debug-banner" style="position:fixed;top:0;left:0;right:0;z-index:9999;background:#fde68a;color:#92400e;font-size:12px;padding:4px 8px;display:none;font-family:monospace;">
		Docs debug active
	</div>
	<nav class="bg-white shadow border-b border-gray-200">
		<div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
			<a href="/dashboard.html" class="text-xl font-bold bg-gradient-to-r from-purple-600 to-blue-500 bg-clip-text text-transparent">Elixopay</a>
			<div class="flex items-center gap-4 text-sm">
				<a href="/dashboard.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.dashboard">Dashboard</a>
				<a href="/transactions.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.transactions">Transactions</a>
				<a href="/security.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.security">Security</a>
				<a href="/help.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.help">Help</a>
				<select id="langSelect" class="border border-gray-300 rounded px-2 py-1">
					<option value="th">TH</option>
					<option value="en">EN</option>
					<option value="zh">中文</option>
				</select>
				<button id="themeToggle" class="text-gray-600 hover:text-gray-900" aria-label="Toggle theme"></button>
			</div>
		</div>
	</nav>

	<header class="max-w-6xl mx-auto px-4 py-10">
		<h1 class="text-3xl font-bold mb-2" data-i18n="docs.title">API Documentation</h1>
		<p class="text-gray-600" data-i18n="docs.subtitle">เวอร์ชันเบื้องต้นของเอกสาร API สำหรับเริ่มต้นใช้งาน</p>
	</header>

	<main class="max-w-6xl mx-auto px-4 pb-16 space-y-10">
		<!DOCTYPE html>
		<html lang="th" class="scroll-smooth">
		<head>
		  <meta charset="UTF-8" />
		  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
		  <title>API Documentation - Elixopay</title>
		  <meta name="description" content="Elixopay API Documentation – Authentication, Payments, Webhooks, Errors" />
		  <script src="https://cdn.tailwindcss.com"></script>
		  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
		  <style>
		    .code-block{position:relative;background:#0f172a;color:#e2e8f0;border-radius:.75rem;padding:1rem;font-family:ui-monospace,monospace;font-size:.75rem;line-height:1.2;}
		    .code-block button{position:absolute;top:.5rem;right:.5rem;background:#1e293b;color:#94a3b8;font-size:.65rem;padding:.35rem .55rem;border-radius:.375rem;border:1px solid #334155;cursor:pointer;}
		    .code-block button:hover{color:#38bdf8;border-color:#38bdf8;}
		    .section-card{transition:box-shadow .25s,transform .25s;}
		    .section-card:hover{box-shadow:0 8px 20px -4px rgba(0,0,0,.08);transform:translateY(-2px);}
		    .anchor-link{opacity:0;transition:opacity .2s;margin-left:.25rem;}
		    h2:hover .anchor-link{opacity:1;}
		    /* Sidebar active indicator */
		    .nav-active{background:linear-gradient(90deg,#6366f1,#3b82f6);color:#fff;font-weight:600;}
		    /* Dark mode overrides */
		    html.dark body{background:#0d1117;color:#cbd5e1;}
		    html.dark .section-card{background:#1e293b;border-color:#334155;}
		    html.dark .code-block{background:#0d1117;color:#e2e8f0;border:1px solid #1e293b;}
		    html.dark .code-block button{background:#1e293b;border-color:#334155;}
		    html.dark nav, html.dark footer{background:#0f172a;border-color:#1e293b;}
		    html.dark table thead{background:#1e293b;}
		  </style>
		</head>
		<body class="bg-gray-50 min-h-screen flex flex-col">
		"token": "<JWT>",
				<div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
		      <div class="flex items-center gap-3">
		        <a href="/" class="text-2xl font-extrabold tracking-tight bg-gradient-to-r from-purple-600 to-blue-500 bg-clip-text text-transparent">Elixopay API Docs</a>
		        <span class="px-2 py-1 text-[10px] uppercase rounded bg-indigo-100 text-indigo-700 font-semibold">v1</span>
		      </div>
		      <div class="flex items-center gap-3 text-xs">
		        <a href="/dashboard.html" class="px-2 py-1 rounded hover:bg-gray-100">Dashboard</a>
		        <a href="/transactions.html" class="px-2 py-1 rounded hover:bg-gray-100">Transactions</a>
		        <a href="/security.html" class="px-2 py-1 rounded hover:bg-gray-100">Security</a>
		        <a href="/help.html" class="px-2 py-1 rounded hover:bg-gray-100">Help</a>
		        <select id="langSelect" class="border border-gray-300 rounded px-2 py-1 text-xs focus:ring-indigo-500 focus:border-indigo-500">
		          <option value="th">TH</option>
		          <option value="en">EN</option>
		          <option value="zh">中文</option>
		        </select>
		        <button id="themeToggle" class="px-3 py-1 rounded border border-gray-300 hover:border-indigo-500 text-gray-700 text-xs flex items-center gap-1" aria-label="Toggle dark mode">
		          <i class="fas fa-moon"></i><span class="hidden sm:inline">Dark</span>
		        </button>
		      </div>
				</div>
						<th class="py-2" data-i18n="docs.payments.th.description">Description</th>

		  <!-- Main Container with Sidebar -->
		  <div class="flex-1 w-full max-w-7xl mx-auto px-4 md:px-6 lg:px-8 py-8 grid grid-cols-1 lg:grid-cols-[240px_1fr] gap-8">
		    <!-- Sidebar -->
		    <aside class="hidden lg:block sticky top-20 self-start">
		      <nav class="space-y-1 text-sm" id="sectionNav">
		        <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Sections</h3>
		        <a href="#authentication" class="block px-3 py-2 rounded hover:bg-gray-100">Authentication</a>
		        <a href="#payments" class="block px-3 py-2 rounded hover:bg-gray-100">Payments</a>
		        <a href="#webhooks" class="block px-3 py-2 rounded hover:bg-gray-100">Webhooks</a>
		        <a href="#errors" class="block px-3 py-2 rounded hover:bg-gray-100">Errors</a>
		        <div class="mt-6 pt-6 border-t border-gray-200">
		          <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Meta</h3>
		          <a href="/SECURITY_README.md" class="block px-3 py-2 rounded hover:bg-gray-100">Security</a>
		          <a href="/help.html" class="block px-3 py-2 rounded hover:bg-gray-100">Help Center</a>
		        </div>
		      </nav>
		    </aside>

			<main class="space-y-12">
				<header class="mb-4 space-y-6">
					<div>
						<h1 class="text-4xl font-extrabold tracking-tight mb-3 bg-gradient-to-r from-indigo-600 to-blue-500 bg-clip-text text-transparent" data-i18n="docs.title">API Documentation</h1>
						<p class="text-gray-600 text-sm leading-relaxed max-w-2xl" data-i18n="docs.subtitle">เวอร์ชันปรับปรุงของเอกสาร API สำหรับผู้พัฒนา – รวมตัวอย่างและแนวทางการใช้งานอย่างปลอดภัย</p>
					</div>
					<div class="flex flex-wrap gap-2 text-xs">
						<span class="px-2 py-1 rounded bg-green-100 text-green-700 font-medium"><i class="fas fa-lock mr-1"></i>Secure</span>
						<span class="px-2 py-1 rounded bg-blue-100 text-blue-700 font-medium"><i class="fas fa-code mr-1"></i>REST JSON</span>
						<span class="px-2 py-1 rounded bg-purple-100 text-purple-700 font-medium"><i class="fas fa-bolt mr-1"></i>Low Latency</span>
						<span class="px-2 py-1 rounded bg-orange-100 text-orange-700 font-medium"><i class="fas fa-rocket mr-1"></i>Quick Start</span>
					</div>
					<div class="flex flex-col md:flex-row gap-4 md:items-center">
						<div class="relative md:w-80">
							<input id="docsSearch" type="search" placeholder="Search sections..." class="w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm focus:ring-indigo-500 focus:border-indigo-500" />
							<i class="fas fa-search absolute right-3 top-2.5 text-gray-400 text-sm"></i>
						</div>
						<button id="mobileNavToggle" class="md:hidden inline-flex items-center gap-2 px-3 py-2 text-xs rounded border border-gray-300 bg-white shadow-sm active:scale-[.97]">
							<i class="fas fa-list"></i><span>Sections</span>
						</button>
					</div>
					<div class="grid md:grid-cols-2 gap-4">
						<div class="section-card bg-white border border-gray-200 rounded-xl p-4 flex items-start gap-3">
							<i class="fas fa-terminal text-indigo-600 mt-1"></i>
							<div class="text-xs leading-relaxed">
								<h3 class="font-semibold mb-1">Quick Start</h3>
								<p>สร้าง API key, ตั้งค่า env, เรียก login, สร้าง payment intent และฟัง webhook.</p>
							</div>
						</div>
						<div class="section-card bg-white border border-gray-200 rounded-xl p-4 flex items-start gap-3">
							<i class="fas fa-shield-alt text-green-600 mt-1"></i>
							<div class="text-xs leading-relaxed">
								<h3 class="font-semibold mb-1">Security Guidance</h3>
								<p>ใช้ HTTPS, หมุนเวียน secret, ตรวจสอบ signature ของทุก webhook, เก็บ token อย่างปลอดภัย.</p>
							</div>
						</div>
					</div>
				</header>

				<!-- Authentication -->
				<section id="authentication" class="section-card bg-white border border-gray-200 rounded-xl p-6">
					<h2 class="text-2xl font-semibold mb-4 flex items-center"><i class="fas fa-key text-purple-600 mr-3"></i><span data-i18n="docs.auth.title">Authentication</span><a href="#authentication" class="anchor-link text-xs text-indigo-500">#</a></h2>
					</tr>
					<div class="code-block" data-code>
		POST /api/v1/auth/login\nContent-Type: application/json\n\n{ "email": "demo@elixopay.com", "password": "Password123" }\n\n# Response (200)\n{\n  "success": true,\n  "data": {\n    "token": "<JWT>",\n    "refreshToken": "<JWT_REFRESH>",\n    "user": { "id": 1, "email": "demo@elixopay.com" }\n  }\n}
		              <button type="button">Copy</button>
		            </div>
		            <div class="mt-4 text-xs text-gray-600 space-y-1">
		              <p>ใช้ <code class="bg-gray-100 px-1 rounded">Authorization: Bearer &lt;token&gt;</code> กับทุก endpoint ที่มีการระบุว่า "Bearer".</p>
		              <p class="flex items-center gap-2"><i class="fas fa-shield-alt text-green-600"></i> ควรเก็บ token ฝั่งเซิร์ฟเวอร์หรือใช้ HttpOnly cookie ใน production.</p>
		            </div>
	-H "Authorization: Bearer $TOKEN" \
	-H "Content-Type: application/json" \
				<!-- Payments -->
				<section id="payments" class="section-card bg-white border border-gray-200 rounded-xl p-6">
					<h2 class="text-2xl font-semibold mb-6 flex items-center"><i class="fas fa-credit-card text-green-600 mr-3"></i><span data-i18n="docs.payments.title">Payments</span><a href="#payments" class="anchor-link text-xs text-indigo-500">#</a></h2>
		</section>

							<tr class="text-left text-gray-600 text-xs uppercase tracking-wider">
		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-plug text-blue-600 mr-2"></i><span data-i18n="docs.webhooks.title">Webhooks</span></h2>
			<p class="text-sm text-gray-700 mb-4" data-i18n="[html]docs.webhooks.desc.html">Stripe จะส่งอีเวนต์มายัง <code class="bg-gray-100 px-1 rounded">/api/v1/webhooks/stripe</code> เพื่ออัปเดตสถานะการชำระเงิน (เช่น <code>payment_intent.succeeded</code>, <code>payment_intent.payment_failed</code>, <code>charge.refunded</code>).</p>
			<div class="bg-gray-900 text-gray-100 text-xs rounded p-4 font-mono overflow-auto">
stripe listen --forward-to http://localhost:3000/api/v1/webhooks/stripe
			</div>
		</section>

		<!-- Errors -->
		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-bug text-red-600 mr-2"></i><span data-i18n="docs.errors.title">Error Handling</span></h2>
			<p class="text-sm text-gray-700 mb-2" data-i18n="docs.errors.shape">ทุก Response ที่ผิดพลาดจะมีรูปแบบ:</p>
			<div class="bg-gray-900 text-gray-100 text-xs rounded p-4 font-mono overflow-auto">
{
	"success": false,
	"error": {
		"code": "VALIDATION_ERROR",
		"message": "Amount must be positive"
	}
}
			</div>
		</section>
	</main>

	<footer class="bg-white border-t border-gray-200 py-6 text-center text-sm text-gray-600">
		<p data-i18n="footer.rights">© 2024 Elixopay API Docs</p>
	</footer>
					<div class="code-block mb-4" data-code>
		curl -X POST "$BASE_URL/api/v1/payments" \\
		  -H "Authorization: Bearer $TOKEN" \\
		  -H "Content-Type: application/json" \\
		  -d '{"amount":299900,"currency":"thb","description":"Test order #1"}'
		              <button type="button">Copy</button>
		            </div>
				if(banner){ banner.style.display='block'; banner.textContent='Docs debug: '+msg; }
				console.log('[docs.html]', msg);
			}
				<!-- Webhooks -->
				<section id="webhooks" class="section-card bg-white border border-gray-200 rounded-xl p-6">
					<h2 class="text-2xl font-semibold mb-4 flex items-center"><i class="fas fa-plug text-blue-600 mr-3"></i><span data-i18n="docs.webhooks.title">Webhooks</span><a href="#webhooks" class="anchor-link text-xs text-indigo-500">#</a></h2>
			const header = document.querySelector('header h1');
					<div class="code-block" data-code>
		stripe listen --forward-to http://localhost:3000/api/v1/webhooks/stripe
		              <button type="button">Copy</button>
		            </div>
		            <ul class="mt-4 text-xs text-gray-600 space-y-1 list-disc list-inside">
		              <li>ควรกำหนด secret ใน <code class="bg-gray-100 px-1 rounded">STRIPE_WEBHOOK_SECRET</code>.</li>
		              <li>ตรวจสอบ signature ทุกครั้งก่อนปรับสถานะ payment.</li>
		            </ul>
					show('body emptied');
				}
				<!-- Errors -->
				<section id="errors" class="section-card bg-white border border-gray-200 rounded-xl p-6">
					<h2 class="text-2xl font-semibold mb-4 flex items-center"><i class="fas fa-bug text-red-600 mr-3"></i><span data-i18n="docs.errors.title">Error Handling</span><a href="#errors" class="anchor-link text-xs text-indigo-500">#</a></h2>
				const hasContent = document.body.textContent.trim().length > 0;
					<div class="code-block" data-code>{\n  "success": false,\n  "error": {\n    "code": "VALIDATION_ERROR",\n    "message": "Amount must be positive"\n  }\n}
		              <button type="button">Copy</button>
		            </div>
		            <div class="mt-4 grid sm:grid-cols-2 gap-4 text-xs">
		              <div class="p-3 rounded-lg bg-red-50 border border-red-200 flex items-start gap-2"><i class="fas fa-times-circle text-red-600 mt-0.5"></i><span><strong>4xx</strong> – Client input ผิด เช่น validation, auth</span></div>
		              <div class="p-3 rounded-lg bg-yellow-50 border border-yellow-200 flex items-start gap-2"><i class="fas fa-exclamation-triangle text-yellow-600 mt-0.5"></i><span><strong>5xx</strong> – Internal error ติดต่อ support พร้อม request id</span></div>
		            </div>
	</script>

		    </main>
		  </div>
		  <footer class="bg-white border-t border-gray-200 py-6 mt-8 text-center text-xs text-gray-600">
		    <p data-i18n="footer.rights">© 2024 Elixopay API Docs • Built for developers</p>
		  </footer>

		<script>
		    // Dark mode toggle
		    const themeBtn = document.getElementById('themeToggle');
		    function applyTheme(t){
		      const html=document.documentElement; if(t==='dark'){html.classList.add('dark');} else {html.classList.remove('dark');}
		      themeBtn.innerHTML = t==='dark' ? '<i class="fas fa-sun"></i><span class="hidden sm:inline">Light</span>' : '<i class="fas fa-moon"></i><span class="hidden sm:inline">Dark</span>';
		      localStorage.setItem('docs_theme', t);
		    }
		    const savedTheme = localStorage.getItem('docs_theme') || 'light';
		    applyTheme(savedTheme);
		    themeBtn.addEventListener('click',()=>{applyTheme(document.documentElement.classList.contains('dark')?'light':'dark');});

		    // Code block copy buttons
		    document.querySelectorAll('.code-block').forEach(block => {
		      const btn = block.querySelector('button');
		      if(!btn) return;
		      btn.addEventListener('click', () => {
		        const text = block.getAttribute('data-code') || block.textContent.trim();
		        navigator.clipboard.writeText(text).then(()=>{
		          btn.textContent='Copied';
		          setTimeout(()=>btn.textContent='Copy',1500);
		        });
		      });
		    });

		    // Scroll spy for sidebar
		    const sections = ['authentication','payments','webhooks','errors'].map(id=>document.getElementById(id));
		    const navLinks = Array.from(document.querySelectorAll('#sectionNav a[href^="#"]'));
		    const observer = new IntersectionObserver(entries => {
		      entries.forEach(e => {
		        if(e.isIntersecting){
		          navLinks.forEach(l=>l.classList.remove('nav-active'));
		          const active = navLinks.find(l=>l.getAttribute('href')===`#${e.target.id}`);
		          if(active) active.classList.add('nav-active');
		        }
		      });
		    }, { rootMargin:'-40% 0px -50% 0px', threshold:0 });
		    sections.forEach(sec=>sec && observer.observe(sec));

			// Live search filter
			const searchInput = document.getElementById('docsSearch');
			const docSections = sections.filter(Boolean);
			searchInput.addEventListener('input', () => {
				const q = searchInput.value.trim().toLowerCase();
				docSections.forEach(sec => {
					const text = sec.textContent.toLowerCase();
					if(q === '' || text.includes(q)) {
						sec.style.display = '';
					} else {
						sec.style.display = 'none';
					}
				});
			});

			// Mobile sidebar toggle
			const mobileBtn = document.getElementById('mobileNavToggle');
			const sidebar = document.querySelector('aside');
			let mobilePanel;
			function ensurePanel(){
				if(mobilePanel) return mobilePanel;
				mobilePanel = document.createElement('div');
				mobilePanel.className='fixed inset-0 z-50 md:hidden';
				mobilePanel.innerHTML = `\n        <div class="absolute inset-0 bg-black/40" data-panel-close></div>\n        <div class="absolute left-0 top-0 bottom-0 w-64 bg-white dark:bg-[#0f172a] shadow-lg p-4 overflow-y-auto">\n          <div class="flex justify-between items-center mb-4">\n            <h3 class="text-sm font-semibold">Sections</h3>\n            <button class="text-gray-500 hover:text-gray-700" data-panel-close><i class="fas fa-times"></i></button>\n          </div>\n          ${document.getElementById('sectionNav').innerHTML}\n        </div>`;
				document.body.appendChild(mobilePanel);
				mobilePanel.addEventListener('click', e=>{ if(e.target.matches('[data-panel-close]')) closePanel(); });
				mobilePanel.querySelectorAll('a[href^="#"]').forEach(a=>{
					a.addEventListener('click', ()=>{ closePanel(); });
				});
				return mobilePanel;
			}
			function openPanel(){ ensurePanel().classList.remove('hidden'); }
			function closePanel(){ ensurePanel().classList.add('hidden'); }
			mobileBtn && mobileBtn.addEventListener('click', ()=>{ openPanel(); });

			// Back to top button
			const backTop = document.createElement('button');
			backTop.type='button';
			backTop.className='hidden fixed bottom-6 right-6 z-40 bg-indigo-600 text-white rounded-full w-10 h-10 shadow-lg text-xs flex items-center justify-center hover:bg-indigo-500 active:scale-95';
			backTop.innerHTML='<i class="fas fa-arrow-up"></i>';
			backTop.addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));
			document.body.appendChild(backTop);
			window.addEventListener('scroll', () => {
				if(window.scrollY > 300){ backTop.classList.remove('hidden'); } else { backTop.classList.add('hidden'); }
			});
		  </script>

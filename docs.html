<!DOCTYPE html>
<html lang="th">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>API Documentation - Elixopay</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">
	<!-- Debug banner (temporary) -->
	<div id="debug-banner" style="position:fixed;top:0;left:0;right:0;z-index:9999;background:#fde68a;color:#92400e;font-size:12px;padding:4px 8px;display:none;font-family:monospace;">
		Docs debug active
	</div>
	<nav class="bg-white shadow border-b border-gray-200">
		<div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
			<a href="/dashboard.html" class="text-xl font-bold bg-gradient-to-r from-purple-600 to-blue-500 bg-clip-text text-transparent">Elixopay</a>
			<div class="flex items-center gap-4 text-sm">
				<a href="/dashboard.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.dashboard">Dashboard</a>
				<a href="/transactions.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.transactions">Transactions</a>
				<a href="/security.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.security">Security</a>
				<a href="/help.html" class="text-gray-600 hover:text-gray-900" data-i18n="nav.help">Help</a>
				<select id="langSelect" class="border border-gray-300 rounded px-2 py-1">
					<option value="th">TH</option>
					<option value="en">EN</option>
					<option value="zh">中文</option>
				</select>
				<button id="themeToggle" class="text-gray-600 hover:text-gray-900" aria-label="Toggle theme"></button>
			</div>
		</div>
	</nav>

	<header class="max-w-6xl mx-auto px-4 py-10">
		<h1 class="text-3xl font-bold mb-2" data-i18n="docs.title">API Documentation</h1>
		<p class="text-gray-600" data-i18n="docs.subtitle">เวอร์ชันเบื้องต้นของเอกสาร API สำหรับเริ่มต้นใช้งาน</p>
	</header>

	<main class="max-w-6xl mx-auto px-4 pb-16 space-y-10">
		<!-- Authentication -->
		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-key text-purple-600 mr-2"></i><span data-i18n="docs.auth.title">Authentication</span></h2>
			<p class="text-sm text-gray-700 mb-4" data-i18n="[html]docs.auth.desc.html">ใช้ <code class="bg-gray-100 px-1 rounded">Bearer &lt;token&gt;</code> ใน Header <code class="bg-gray-100 px-1 rounded">Authorization</code> หลังจากล็อกอินสำเร็จ</p>
			<div class="bg-gray-900 text-gray-100 text-xs rounded p-4 font-mono overflow-auto">
POST /api/v1/auth/login
Content-Type: application/json

{ "email": "demo@elixopay.com", "password": "demo1234" }

# Response (200)
{
	"success": true,
	"data": {
		"token": "<JWT>",
		"refreshToken": "<JWT_REFRESH>",
		"user": { "id": 1, "email": "demo@elixopay.com" }
	}
}
			</div>
		</section>

		<!-- Payments -->
		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-credit-card text-green-600 mr-2"></i><span data-i18n="docs.payments.title">Payments</span></h2>
			<table class="w-full text-sm mb-4">
				<thead>
					<tr class="text-left text-gray-600">
						<th class="py-2" data-i18n="docs.payments.th.endpoint">Endpoint</th>
						<th class="py-2" data-i18n="docs.payments.th.method">Method</th>
						<th class="py-2" data-i18n="docs.payments.th.description">Description</th>
						<th class="py-2" data-i18n="docs.payments.th.auth">Auth</th>
					</tr>
				</thead>
				<tbody class="divide-y">
					<tr>
						<td>/api/v1/payments</td><td>POST</td><td>Create Payment (Stripe Intent)</td><td>Bearer</td>
					</tr>
					<tr>
						<td>/api/v1/payments/:id/confirm</td><td>POST</td><td>Confirm Payment Intent</td><td>Bearer</td>
					</tr>
					<tr>
						<td>/api/v1/payments/:id/cancel</td><td>POST</td><td>Cancel Pending Payment</td><td>Bearer</td>
					</tr>
					<tr>
						<td>/api/v1/payments/:id/refund</td><td>POST</td><td>Refund a Succeeded Payment</td><td>Bearer</td>
					</tr>
					<tr>
						<td>/api/v1/payments/stats</td><td>GET</td><td>Aggregate Statistics</td><td>Bearer</td>
					</tr>
					<tr>
						<td>/api/v1/payments</td><td>GET</td><td>List Payments (query params)</td><td>Bearer</td>
					</tr>
				</tbody>
			</table>
			<div class="bg-gray-900 text-gray-100 text-xs rounded p-4 font-mono overflow-auto mb-4">
curl -X POST "$BASE_URL/api/v1/payments" \
	-H "Authorization: Bearer $TOKEN" \
	-H "Content-Type: application/json" \
	-d '{"amount":299900,"currency":"thb","description":"Test order #1"}'
			</div>
			<p class="text-xs text-gray-500" data-i18n="docs.payments.note">หมายเหตุ: จำนวนเงิน (amount) ใช้หน่วยเป็นสตางค์ (เช่น 2,999.00 บาท = 299900)</p>
		</section>

		<!-- Webhooks -->
		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-plug text-blue-600 mr-2"></i><span data-i18n="docs.webhooks.title">Webhooks</span></h2>
			<p class="text-sm text-gray-700 mb-4" data-i18n="[html]docs.webhooks.desc.html">Stripe จะส่งอีเวนต์มายัง <code class="bg-gray-100 px-1 rounded">/api/v1/webhooks/stripe</code> เพื่ออัปเดตสถานะการชำระเงิน (เช่น <code>payment_intent.succeeded</code>, <code>payment_intent.payment_failed</code>, <code>charge.refunded</code>).</p>
			<div class="bg-gray-900 text-gray-100 text-xs rounded p-4 font-mono overflow-auto">
stripe listen --forward-to http://localhost:3000/api/v1/webhooks/stripe
			</div>
		</section>

		<!-- Errors -->
		<section class="bg-white rounded-lg shadow p-6">
			<h2 class="text-xl font-semibold mb-4"><i class="fas fa-bug text-red-600 mr-2"></i><span data-i18n="docs.errors.title">Error Handling</span></h2>
			<p class="text-sm text-gray-700 mb-2" data-i18n="docs.errors.shape">ทุก Response ที่ผิดพลาดจะมีรูปแบบ:</p>
			<div class="bg-gray-900 text-gray-100 text-xs rounded p-4 font-mono overflow-auto">
{
	"success": false,
	"error": {
		"code": "VALIDATION_ERROR",
		"message": "Amount must be positive"
	}
}
			</div>
		</section>
	</main>

	<footer class="bg-white border-t border-gray-200 py-6 text-center text-sm text-gray-600">
		<p data-i18n="footer.rights">© 2024 Elixopay API Docs</p>
	</footer>

	<script>
		// Simple runtime diagnostics to help investigate blank screen issue
		(function(){
			const banner = document.getElementById('debug-banner');
			function show(msg){
				if(banner){ banner.style.display='block'; banner.textContent='Docs debug: '+msg; }
				console.log('[docs.html]', msg);
			}
			show('script start');
			const twOk = typeof tailwind !== 'undefined';
			show('tailwindLoaded='+twOk);
			const header = document.querySelector('header h1');
			show('headerFound='+(!!header));
			const obs = new MutationObserver(()=>{
				if(!document.body || document.body.children.length===0){
					show('body emptied');
				}
			});
			obs.observe(document.body,{childList:true});
			window.addEventListener('load', ()=>{
				const hasContent = document.body.textContent.trim().length > 0;
				show('onload hasContent='+hasContent);
				if(!hasContent){
					const fallback = document.createElement('div');
					fallback.innerHTML = '<h1 style="padding:2rem;font-family:sans-serif">API Docs Fallback Render</h1>';
					document.body.appendChild(fallback);
					show('fallback injected');
				}
			});
		})();
	</script>
	<script src="js/i18n.js?v=2"></script>
	<script src="js/ui.js?v=2"></script>
</body>
</html>
